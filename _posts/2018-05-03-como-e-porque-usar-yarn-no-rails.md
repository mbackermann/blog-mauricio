---
title: "Como e por que usar Yarn no Rails?"
excerpt: "O Yarn facilita o gerenciamento de dependÃªncias de bibliotecas, alÃ©m de ser rÃ¡pido e fÃ¡cil de usar"
header:
  teaser: "/assets/images/yarn_rails.jpg"

categories:
  - ruby-on-rails
tags:
  - ruby-on-rails
  - javascript
  - yarn
---
O __Yarn__ Ã© um gerenciador de pacotes bem parecido com o NPM, que roda em cima do __NodeJS__, criado pelo Facebook com o intuito de substituir o NPM, trazendo mais velocidade para o __gerenciamento de pacotes__, jÃ¡ que ele paraleliza instalaÃ§Ãµes de pacotes.

A vantagem de usÃ¡-lo com o __Rails__ Ã© que vocÃª facilita o gerenciamento das bibliotecas CSS e Javascript de seu projeto. Seu funcionamento Ã© bem parecido com as __*gems*__ do Ruby, sÃ³ que para o universo front-end.

No Rails Ã© comum procurarmos por gems que facilitam a utilizaÃ§Ã£o dessas bibliotecas em nossos projetos, mas ficamos dependente de atualizaÃ§Ãµes das mesmas. O Yarn Ã© uma boa soluÃ§Ã£o pra tudo isso.

Para instalar o Yarn no Mac, basta rodar

```
brew install yarn
```

Agora vamos ver como aplicar em nossos projetos

Para isso, vou criar um novo projeto Rails:

```
rails new rails-yarn
cd rails-yarn/
```

Vamos iniciar o Yarn em nosso projeto com o seguinte comando:
```
yarn init
```

O terminal irÃ¡ te fazer uma sÃ©rie de perguntas a respeito do seu projeto. VocÃª nÃ£o precisa preencher se nÃ£o quiser
```
yarn init v1.5.1
question name (rails-yarn):
question version (1.0.0):
question description:
question entry point (index.js):
question repository url:
question author (MaurÃ­cio Ackerman):
question license (MIT):
question private (true):
success Saved package.json
âœ¨  Done in 8.22s.
```

Veja que ao finalizar o comando, um novo arquivo __*package.json*__ Ã© criado na raiz do seu projeto. Esse arquivo centraliza todas as informaÃ§Ãµes do seu projeto, bem como suas dependÃªncias
```json
{
  "name": "rails-yarn",
  "private": true,
  "dependencies": {},
  "version": "1.0.0",
  "main": "index.js",
  "author": "MaurÃ­cio Ackermann",
  "license": "MIT"
}
```

Vamos adicionar uma dependÃªncia em nosso projet:
```
$ yarn add jquery
yarn add v1.5.1
info No lockfile found.
[1/4] ğŸ”  Resolving packages...
[2/4] ğŸšš  Fetching packages...
[3/4] ğŸ”—  Linking dependencies...
[4/4] ğŸ“ƒ  Building fresh packages...
success Saved lockfile.
warning Your current version of Yarn is out of date. The latest version is "1.6.0", while you're on "1.5.1".
info To upgrade, run the following command:
$ curl -o- -L https://yarnpkg.com/install.sh | bash
success Saved 1 new dependency.
info Direct dependencies
â””â”€ jquery@3.3.1
info All dependencies
â””â”€ jquery@3.3.1
âœ¨  Done in 0.78s.
```

Veja que na terceira linha, ele fala _info No lockfile found._ e na 8 liva temos o seguinte output: _success Saved lockfile._. O Yarn utiliza um arquivo chamado yarn.lock para salvar as informaÃ§Ãµes de todas as versÃµes de nossas dependÃªncias, bem parecido com o arquivo Gemfile.lock de nossos projetos Rails. Isso garante a consistÃªncia das versÃµes das dependÃªncias de seu projeto, evitando que em cada ambiente rode uma versÃ£o diferente.

Yarn.lock
```
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


jquery@^3.3.1:
  version "3.3.1"
  resolved "https://registry.yarnpkg.com/jquery/-/jquery-3.3.1.tgz#958ce29e81c9790f31be7792df5d4d95fc57fbca"
```

Agora que instalamos a biblioteca, vamos adicionar ao nosso projeto. Para isso, vamos editar o arquivo __*app/assets/javascripts/application.js*__ adicionado o jquery:
```javascript
//= require jquery
```

Pronto, seu projeto jÃ¡ estÃ¡ com o jQuery funcionando graÃ§as ao Yarn. Ã‰ importante vocÃª adicionar ao seu __*.gitignore*__ a pasta __*node_modules*__, para que as bibliotecas nÃ£o sejam comitadas junto ao seu projeto.

Ao clonar o repositÃ³rio, para instalar as dependÃªncias basta rodar o comando
```
yarn install
```

O que vocÃª achou dessa alternativa para gerenciamento de suas bibliotecas? Simples e rÃ¡pido, alÃ©m de ser super recomendada, nÃ£o Ã© mesmo? Deixe seu comentÃ¡rio sobre como vocÃª estÃ¡ utilizando o Yarn em seus projetos.

Num prÃ³xio artigo vou falar da utilizaÃ§Ã£o do Webpack nos projetos Rails, substituindo o Sprockets.
